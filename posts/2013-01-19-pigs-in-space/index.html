



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="A data scientist's journey through data hell and back again">
      
      
        <link rel="canonical" href="https://www.shawnhermans.com/posts/2013-01-19-pigs-in-space/">
      
      
        <meta name="author" content="S">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.0">
    
    
      
        <title>Pigs in Space</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.0284f74d.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.01803549.css">
      
      
        
        
        <meta name="theme-color" content="#2196f3">
      
    
    
      <script src="../../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="blue" data-md-color-accent="blue">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#introduction" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://www.shawnhermans.com" title="Shawn Hermans" class="md-header-nav__button md-logo">
          
            <i class="md-icon">gesture</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Shawn Hermans
            </span>
            <span class="md-header-nav__topic">
              
                Pigs in Space
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

<nav class="md-tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href="../.." title="Home" class="md-tabs__link md-tabs__link--active">
        Home
      </a>
    
  </li>

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://www.shawnhermans.com" title="Shawn Hermans" class="md-nav__button md-logo">
      
        <i class="md-icon">gesture</i>
      
    </a>
    Shawn Hermans
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>Alas, the subject of this post is about using Apache Pig to process satellite orbit data.
If you are an orbital analyst and want to know how to easily process data on a Hadoop cluster,
this article is for you. If you are just interested in Pig, this post should give you a good idea of
how to use Pig and write Jython-based Pig user defined functions.</p>
<!--break-->

<h2 id="setting-up-pig">Setting Up Pig<a class="headerlink" href="#setting-up-pig" title="Permanent link">&para;</a></h2>
<p>Pig can run in either local mode or Hadoop mode. I am not going to go into great detail on how to
setup Pig using Hadoop mode. Hadoop mode requires a fully configured Hadoop cluster with MapReduce version 1.
If you are using Cloudera or some other Hadoop distribution, I recommend using whatever release of Pig that comes
bundled with their distribution.</p>
<p>Setting up Pig in standalone mode is much more straightforward. To setup Pig in standalone mode, download the
latest <a href="http://pig.apache.org/releases.html">Pig release</a>. At the time of this writing, the latest Pig
version is 10.1. Next, set the <code class="codehilite"><span class="n">JAVA_HOME</span></code> environment variable. On an Ubuntu based system,
add the following into <code class="codehilite"><span class="err">$</span><span class="n">HOME</span><span class="o">/</span><span class="p">.</span><span class="n">profile</span></code>.</p>
<div class="codehilite"><pre><span></span><span class="n">JAVA_HOME</span> <span class="n">export</span> <span class="n">JAVA_HOME</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">jvm</span><span class="o">/</span><span class="k">default</span><span class="o">-</span><span class="n">java</span>
</pre></div>


<p>Decompress the Pig distribution. Common locations include <code class="codehilite"><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">pig</span></code> or <code class="codehilite"><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="k">local</span><span class="o">/</span><span class="n">pig</span></code>.
This directory is the <code class="codehilite"><span class="n">PIG_HOME</span></code> directory. Starting Pig in standalone mode is as simple as executing the
command <code class="codehilite"><span class="err">$</span><span class="n">PIG_HOME</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">pig</span> <span class="o">-</span><span class="n">x</span> <span class="k">local</span></code>. This will drop you into the Pig interactive shell Grunt.
You are now ready to start processing some data in Pig!</p>
<h2 id="getting-and-preparing-the-data">Getting and Preparing the Data<a class="headerlink" href="#getting-and-preparing-the-data" title="Permanent link">&para;</a></h2>
<p>There are a few sources of orbital data available. <a href="https://www.space-track.org/">Space-Track.org</a> hosts the
full public catalog and contains
roughly 14,000 objects. Access to this data requires registration and may not be readily accessible to all users.
As an alternative, <a href="https://celestrak.com/">Celestrak</a> hosts publicly available, supplemental TLEs.
I will use these TLEs with the rest of the examples. Because Celestrak uses the same format as Space-Track.org,
these examples should work equally as well against the full satellite catalog.
Download the GPS ops TLEs. Despite what the name two-line element set would have you believe, most element sets
come with three lines. The first line is the name of the object and the other two lines are the traditional TLE
orbital elements. A typical file looks like this.</p>
<div class="codehilite"><pre><span></span><span class="n">GPS</span> <span class="n">BIIA</span><span class="o">-</span><span class="mi">10</span> <span class="p">(</span><span class="n">PRN</span> <span class="mi">32</span><span class="p">)</span>
<span class="mi">1</span> <span class="mi">20959</span><span class="k">C</span> <span class="mi">90103</span><span class="n">A</span>   <span class="mi">13019</span><span class="p">.</span><span class="mi">82648148</span>  <span class="p">.</span><span class="mi">00000000</span>  <span class="mi">00000</span><span class="o">-</span><span class="mi">0</span>  <span class="p">...</span>
<span class="mi">2</span> <span class="mi">20959</span>  <span class="mi">54</span><span class="p">.</span><span class="mi">4316</span> <span class="mi">229</span><span class="p">.</span><span class="mi">8752</span> <span class="mi">0117400</span> <span class="mi">335</span><span class="p">.</span><span class="mi">3880</span>   <span class="mi">9</span><span class="p">.</span><span class="mi">5445</span> <span class="p">...</span>
<span class="n">GPS</span> <span class="n">BIIA</span><span class="o">-</span><span class="mi">14</span> <span class="p">(</span><span class="n">PRN</span> <span class="mi">26</span><span class="p">)</span>
<span class="mi">1</span> <span class="mi">22014</span><span class="k">C</span> <span class="mi">92039</span><span class="n">A</span>   <span class="mi">13019</span><span class="p">.</span><span class="mi">82648148</span>  <span class="p">.</span><span class="mi">00000000</span>  <span class="mi">00000</span><span class="o">-</span><span class="mi">0</span>  <span class="p">...</span>
<span class="mi">2</span> <span class="mi">22014</span>  <span class="mi">56</span><span class="p">.</span><span class="mi">1808</span> <span class="mi">290</span><span class="p">.</span><span class="mi">0954</span> <span class="mi">0208678</span>  <span class="mi">69</span><span class="p">.</span><span class="mi">4189</span>  <span class="mi">64</span><span class="p">.</span><span class="mi">1323</span>  <span class="p">...</span>
<span class="p">.</span>
<span class="p">.</span>
<span class="p">.</span>
</pre></div>


<p>The problem with this format is that Pig, and most other data processing tools, assume one record per line.
I could develop a custom Pig file loader, but that will have to wait for a later time. Instead,
I created a simple Python script to convert the traditional format into a Pig friendly
tab-separated value format.</p>
<div class="codehilite"><pre><span></span><span class="n">f_out</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;gps-ops.tsv&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span>
<span class="n">output_line</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;gps-ops.txt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line_number</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">line_number</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">!=</span><span class="mi">2</span><span class="p">:</span>
            <span class="n">output_line</span> <span class="o">+=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">output_line</span> <span class="o">+=</span> <span class="n">line</span>
            <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">output_line</span><span class="p">)</span>
            <span class="n">output_line</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="n">f_out</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>

<p>After processing, the file now looks like this.</p>
<div class="codehilite"><pre><span></span><span class="n">GPS</span> <span class="n">BIIA</span><span class="o">-</span><span class="mi">10</span> <span class="p">(</span><span class="n">PRN</span> <span class="mi">32</span><span class="p">)</span>        <span class="mi">1</span> <span class="mi">20959</span><span class="n">U</span><span class="p">...</span><span class="mi">8413</span> <span class="mi">2</span> <span class="mi">20959</span><span class="p">...</span><span class="mi">13</span>
<span class="n">GPS</span> <span class="n">BIIA</span><span class="o">-</span><span class="mi">14</span> <span class="p">(</span><span class="n">PRN</span> <span class="mi">26</span><span class="p">)</span>        <span class="mi">1</span> <span class="mi">22014</span><span class="n">U</span><span class="p">...</span><span class="mi">6335</span> <span class="mi">2</span> <span class="mi">22014</span><span class="p">...</span><span class="mi">17</span>
<span class="p">.</span>
<span class="p">.</span>
<span class="p">.</span>
</pre></div>


<p>The data is now in a Pig friendly format.</p>
<h2 id="loading-the-data">Loading the Data<a class="headerlink" href="#loading-the-data" title="Permanent link">&para;</a></h2>
<p>Our first step is loading the data into Pig. I suggest creating a Pig workspace folder. Copy all data files and
scripts into this directory. Then, while in this directory, execute <code class="codehilite"><span class="n">pig</span> <span class="o">-</span><span class="n">x</span> <span class="k">local</span></code>.</p>
<div class="codehilite"><pre><span></span><span class="nt">grunt</span><span class="o">&gt;</span> <span class="nt">gps</span> <span class="o">=</span> <span class="nt">LOAD</span> <span class="s1">&#39;gps-ops.tsv&#39;</span> <span class="nt">USING</span> <span class="nt">PigStorage</span><span class="o">()</span>
    <span class="nt">AS</span> <span class="o">(</span><span class="nt">name</span><span class="p">:</span><span class="nd">chararray</span><span class="o">,</span> <span class="nt">line1</span><span class="p">:</span><span class="nd">chararray</span><span class="o">,</span> <span class="nt">line2</span><span class="p">:</span><span class="nd">chararray</span><span class="o">);</span>
</pre></div>

<p>This statement creates a relation called <code class="codehilite"><span class="n">gps</span></code>. It loads data from the local file <code class="codehilite"><span class="n">gps</span><span class="o">-</span><span class="n">ops</span><span class="p">.</span><span class="n">tsv</span></code>.
<code class="codehilite"><span class="n">PigStorage</span><span class="p">()</span></code> looks for the data on the local file system if in local mode.
It loads from the HDFS filesystem if run in MapReduce mode.
Loading the data as <code class="codehilite"><span class="p">(</span><span class="n">name</span><span class="p">:</span><span class="n">chararray</span><span class="p">,</span> <span class="n">line1</span><span class="p">:</span><span class="n">chararray</span><span class="p">,</span> <span class="n">line2</span><span class="p">:</span><span class="n">chararray</span><span class="p">)</span></code> tells Pig there are three fields and these
fields are all strings.
If I left that last part off, Pig would still load the data, but would interpret the columns as untyped byte arrays.
This is part of Pig’s philosophy of “pigs eat anything”. If you have type information, Pig will gladly use it.
If you don’t, Pig doesn’t care.</p>
<p>At this point, let’s see what Pig has actually done.
The <code class="codehilite"><span class="k">DESCRIBE</span></code> command will tell us information on the relation.
This is not too useful right now, but comes in handy when dealing with derived relationships.</p>
<div class="codehilite"><pre><span></span><span class="n">grunt</span> <span class="o">&gt;</span> <span class="k">DESCRIBE</span> <span class="n">gps</span><span class="p">;</span>
<span class="n">gps</span><span class="p">:</span> <span class="err">{</span><span class="n">name</span><span class="p">:</span> <span class="n">chararray</span><span class="p">,</span><span class="n">line1</span><span class="p">:</span> <span class="n">chararray</span><span class="p">,</span><span class="n">line2</span><span class="p">:</span> <span class="n">chararray</span><span class="err">}</span>
</pre></div>

<p>We can take a look at the data using the DUMP command.</p>
<div class="codehilite"><pre><span></span><span class="n">grunt</span> <span class="o">&gt;</span> <span class="n">DUMP</span> <span class="n">gps</span><span class="p">;</span>

<span class="p">(</span><span class="n">GPS</span> <span class="n">BIIA</span><span class="o">-</span><span class="mi">10</span> <span class="p">(</span><span class="n">PRN</span> <span class="mi">32</span><span class="p">),</span><span class="mi">1</span> <span class="p">...</span> <span class="o">-</span><span class="mi">3</span> <span class="mi">0</span>  <span class="mi">8413</span><span class="p">,</span><span class="mi">2</span> <span class="p">...</span>  <span class="mi">2</span><span class="p">.</span><span class="mi">00550870162199</span><span class="p">)</span>
<span class="p">(</span><span class="n">GPS</span> <span class="n">BIIA</span><span class="o">-</span><span class="mi">14</span> <span class="p">(</span><span class="n">PRN</span> <span class="mi">26</span><span class="p">),</span><span class="mi">1</span> <span class="p">...</span> <span class="o">-</span><span class="mi">3</span> <span class="mi">0</span>  <span class="mi">6335</span><span class="p">,</span><span class="mi">2</span> <span class="p">...</span> <span class="mi">2</span><span class="p">.</span><span class="mi">00565888143921</span><span class="p">)</span>
<span class="p">.</span>
<span class="p">.</span>
<span class="p">.</span>
</pre></div>

<h2 id="creating-a-python-user-defined-function">Creating a Python User Defined Function<a class="headerlink" href="#creating-a-python-user-defined-function" title="Permanent link">&para;</a></h2>
<p>While the data is currently in Pig, it requires further parsing before we can do anything useful with it.
The data is encoded in the positions within the string. For example, columns 15-17 in line 1 represent the
international designator. Lines 45-52 are the second time derivative of mean motion divided by six with
the decimal point assumed. We can’t do much else with the data until we parse it.</p>
<p>While it may be possible to parse this using built-in Pig capabilities, it is a whole lot easier parsing this is
something like Python. Luckily, Pig supports creating user defined functions (UDFs) using Java, JavaScript,
Python and Ruby.</p>
<p>Pig UDFs can use most external Python libraries provided they do not have any C dependencies.
This eliminates popular data processing libraries such as Lxml and NumPy. Additionally, external libraries
cannot rely on Python features found in releases after 2.5. This is because Pig UDFs use Jython to interpret
Python UDFs. The upside of using Jython is that Pig UDFs can call Java classes as if they were native Python
libraries. I will demonstrate this feature later on.</p>
<p>I created a simple UDF called parseTle that takes in the name, line1, and line2 data and parses it into a map.
A map is one of Pig’s complex data types and is equivalent to a Python dictionary.</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">tleparser</span>

<span class="nd">@outputSchema</span><span class="p">(</span><span class="s2">&quot;params:map[]&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">parseTle</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">line1</span><span class="p">,</span> <span class="n">line2</span><span class="p">):</span>
    <span class="n">params</span> <span class="o">=</span> <span class="n">tleparser</span><span class="o">.</span><span class="n">parse_tle</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">line1</span><span class="p">,</span> <span class="n">line2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">params</span>
</pre></div>

<p>The UDF is pretty simple to understand. It imports an external library called
<a href="https://gist.github.com/shawnhermans/4569360">tleparser</a> to do most of the heavy lifting.
The <code class="codehilite"><span class="nv">@outputSchema</span><span class="p">(</span><span class="ss">&quot;params:map[]&quot;</span><span class="p">)</span><span class="w"></span></code> annotation tells Pig this function outputs a map named params.
The easiest way to use this UDF is to place the UDF script and all dependencies in the working folder.
Create the files <code class="codehilite"><span class="n">tleUDFs</span><span class="p">.</span><span class="n">py</span></code> and <code class="codehilite"><span class="n">tleparser</span><span class="p">.</span><span class="n">py</span></code> in this folder and restart the Grunt console.</p>
<p><div class="codehilite"><pre><span></span><span class="nt">grunt</span><span class="o">&gt;</span> <span class="nt">gps</span> <span class="o">=</span> <span class="nt">LOAD</span> <span class="s1">&#39;gps-ops.tsv&#39;</span> <span class="nt">USING</span> <span class="nt">PigStorage</span><span class="o">()</span>
    <span class="nt">AS</span> <span class="o">(</span><span class="nt">name</span><span class="p">:</span><span class="nd">chararray</span><span class="o">,</span> <span class="nt">line1</span><span class="p">:</span><span class="nd">chararray</span><span class="o">,</span> <span class="nt">line2</span><span class="p">:</span><span class="nd">chararray</span><span class="o">);</span>
<span class="nt">grunt</span><span class="o">&gt;</span> <span class="nt">REGISTER</span> <span class="s1">&#39;tleUDFs.py&#39;</span> <span class="nt">USING</span> <span class="nt">jython</span> <span class="nt">AS</span> <span class="nt">myfuncs</span><span class="o">;</span>
<span class="nt">grunt</span><span class="o">&gt;</span> <span class="nt">parsed</span> <span class="o">=</span> <span class="nt">FOREACH</span> <span class="nt">gps</span> <span class="nt">GENERATE</span> <span class="nt">myfuncs</span><span class="p">.</span><span class="nc">parseTle</span><span class="o">(*);</span>
</pre></div>
This Pig command goes through each of the relations in gps and applies the <code class="codehilite"><span class="n">parseTle</span></code> UDF.
The parsed data is now a map of key/value pairs. The following is an example parsed TLE data.</p>
<div class="codehilite"><pre><span></span><span class="p">(</span>
    <span class="p">[</span><span class="n">bstar</span><span class="o">#</span><span class="p">,</span><span class="n">arg_of_perigee</span><span class="o">#</span><span class="mi">333</span><span class="p">.</span><span class="mi">0924</span><span class="p">,</span>
    <span class="n">mean_motion</span><span class="o">#</span><span class="mi">2</span><span class="p">.</span><span class="mi">00559335</span><span class="p">,</span> <span class="n">element_number</span><span class="o">#</span><span class="mi">72</span><span class="p">,</span>
    <span class="n">epoch_year</span><span class="o">#</span><span class="mi">2013</span><span class="p">,</span><span class="n">inclination</span><span class="o">#</span><span class="mi">54</span><span class="p">.</span><span class="mi">9673</span><span class="p">,</span>
    <span class="n">mean_anomaly</span><span class="o">#</span><span class="mi">26</span><span class="p">.</span><span class="mi">8787</span><span class="p">,</span><span class="n">rev_at_epoch</span><span class="o">#</span><span class="mi">210</span><span class="p">,</span>
    <span class="n">mean_motion_ddot</span><span class="o">#</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">eccentricity</span><span class="o">#</span><span class="mi">5</span><span class="p">.</span><span class="mi">354</span><span class="n">E</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">two_digit_year</span><span class="o">#</span><span class="mi">13</span><span class="p">,</span><span class="n">international_designator</span><span class="o">#</span><span class="mi">12053</span><span class="n">A</span><span class="p">,</span>
    <span class="n">classification</span><span class="o">#</span><span class="n">U</span><span class="p">,</span><span class="n">epoch_day</span><span class="o">#</span><span class="mi">17</span><span class="p">.</span><span class="mi">78040066</span><span class="p">,</span>
    <span class="n">satellite_number</span><span class="o">#</span><span class="mi">38833</span><span class="p">,</span>
    <span class="n">name</span><span class="o">#</span><span class="n">GPS</span> <span class="n">BIIF</span><span class="o">-</span><span class="mi">3</span>  <span class="p">(</span><span class="n">PRN</span> <span class="mi">24</span><span class="p">),</span>
    <span class="n">mean_motion_dot</span><span class="o">#-</span><span class="mi">1</span><span class="p">.</span><span class="mi">8</span><span class="n">E</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="n">ra_of_asc_node</span><span class="o">#</span><span class="mi">344</span><span class="p">.</span><span class="mi">5315</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>

<p>Pig uses the <code class="codehilite"><span class="o">#</span></code> character to separate key/value pairs.
Having the data parsed, means we can use the power of Pig to filter, process, and otherwise manipulate it.
The following is an example of using the <code class="codehilite"><span class="n">FILTER</span></code> command to find all orbits with inclination between 53 and 56.</p>
<div class="codehilite"><pre><span></span><span class="n">filtered</span> <span class="o">=</span> <span class="n">FILTER</span> <span class="n">parsed</span> <span class="k">BY</span> <span class="p">(</span><span class="n">params</span><span class="o">#</span><span class="s1">&#39;inclination&#39;</span> <span class="o">&gt;</span> <span class="mi">53</span><span class="p">)</span> 
    <span class="k">AND</span> <span class="p">(</span><span class="n">params</span><span class="o">#</span><span class="s1">&#39;inclination&#39;</span> <span class="o">&lt;</span> <span class="mi">56</span><span class="p">);</span>
</pre></div>

<p>At this point, we can store the results of this processing to the filesystem using the <code class="codehilite"><span class="n">STORE</span></code> command.</p>
<div class="codehilite"><pre><span></span><span class="n">STORE</span> <span class="n">filtered</span> <span class="k">into</span> <span class="s1">&#39;/tmp/filtered&#39;</span> <span class="k">using</span> <span class="n">PigStorage</span><span class="p">();</span>
</pre></div>

<p>After running this command, there should be a folder named <code class="codehilite"><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">filtered</span></code> with a file called part-m-00000.
For larger data sets with more reducers, this folder will contain multiple files using the same naming convention.
This file is a tab-separated representation of the filtered data.
This data can be loaded back into Pig using the PigStorage option.</p>
<h1 id="making-a-pig-script">Making a Pig Script<a class="headerlink" href="#making-a-pig-script" title="Permanent link">&para;</a></h1>
<p>Up until now, all of the examples used the Grunt interactive console.
This is very useful for conducting data exploration,
but not very useful for doing repeatable tasks. Luckily, creating a Pig script is as easy as saving those commands
into a text file and executing it using the Pig commandline.</p>
<p>To create really useful scripts we want to vary certain parameters at runtime.
This is accomplished using Pig parameter substitution. Save the previous commands into a file called <code class="codehilite"><span class="n">filter</span><span class="p">.</span><span class="n">pig</span></code>,
but change the last line to include the following.</p>
<div class="codehilite"><pre><span></span><span class="nt">REGISTER</span> <span class="s1">&#39;tleUDFs.py&#39;</span> <span class="nt">USING</span> <span class="nt">jython</span> <span class="nt">AS</span> <span class="nt">tleUDFs</span><span class="o">;</span>

<span class="nt">gps</span> <span class="o">=</span> <span class="nt">LOAD</span> <span class="s1">&#39;$input&#39;</span> <span class="nt">USING</span> <span class="nt">PigStorage</span><span class="o">()</span> <span class="nt">AS</span> 
    <span class="o">(</span><span class="nt">name</span><span class="p">:</span><span class="nd">chararray</span><span class="o">,</span> <span class="nt">line1</span><span class="p">:</span><span class="nd">chararray</span><span class="o">,</span> <span class="nt">line2</span><span class="p">:</span><span class="nd">chararray</span><span class="o">);</span>

<span class="nt">parsed</span> <span class="o">=</span> <span class="nt">FOREACH</span> <span class="nt">gps</span> <span class="nt">GENERATE</span> <span class="nt">tleUDFs</span><span class="p">.</span><span class="nc">parseTle</span><span class="o">(*);</span>

<span class="nt">filtered</span> <span class="o">=</span> <span class="nt">FILTER</span> <span class="nt">parsed</span> <span class="nt">BY</span>
    <span class="o">(</span><span class="nt">params</span><span class="err">#</span><span class="s1">&#39;inclination&#39;</span> <span class="o">&gt;</span> <span class="o">$</span><span class="nt">lowerInclination</span><span class="o">)</span> <span class="nt">AND</span>
    <span class="o">(</span><span class="nt">params</span><span class="err">#</span><span class="s1">&#39;inclination&#39;</span> <span class="o">&lt;</span> <span class="o">$</span><span class="nt">upperInclination</span><span class="o">);</span>

<span class="nt">STORE</span> <span class="nt">filtered</span> <span class="nt">into</span> <span class="s1">&#39;$output&#39;</span> <span class="nt">using</span> <span class="nt">PigStorage</span><span class="o">();</span>
</pre></div>

<p>This allows the user to pass in lower and upper inclination bounds. It also stores the
results into a user defined output directory. We pass those parameters using the commandline <code class="codehilite"><span class="o">-</span><span class="n">param</span></code> option.</p>
<div class="codehilite"><pre><span></span><span class="n">pig</span> <span class="o">-</span><span class="n">x</span> <span class="k">local</span> <span class="o">-</span><span class="n">param</span> <span class="k">input</span><span class="o">=</span><span class="s1">&#39;gps-ops.tsv&#39;</span> <span class="o">-</span><span class="n">param</span> <span class="n">lowerInclination</span><span class="o">=</span><span class="mi">53</span> <span class="err">\</span>
<span class="o">-</span><span class="n">param</span> <span class="n">upperInclination</span><span class="o">=</span><span class="mi">56</span> <span class="o">-</span><span class="n">param</span> <span class="k">output</span><span class="o">=</span><span class="s1">&#39;/tmp/filtered&#39;</span> <span class="n">filter</span><span class="p">.</span><span class="n">pig</span>
</pre></div>


<h1 id="using-java-in-python-udfs">Using Java in Python UDFs<a class="headerlink" href="#using-java-in-python-udfs" title="Permanent link">&para;</a></h1>
<p>By themselves, orbital elements are not terribly useful. The most common use case for
TLEs is to use the TLEs to propagate out predicted positions and velocities for objects in space.
This requires access to a propagator that implements all the relevant mathematics and physics.
Ideally, we want to create UDF that propagates out the TLE.
Usually, when I want to propagate a TLE in Python, I use <a href="http://rhodesmill.org/pyephem/">PyEphem</a>.</p>
<p>Unfortunately, I can’t use PyEphem to write Pig UDFs. Pig uses Jython to interpret Python UDFs.
Using Jython means you can’t use any Python code requiring C extensions.
It also means you are limited to using standard library functions found in Python 2.5 as Jython does
not support the latest versions of Python. On the other hand, Jython allows for seamless integration
with existing Java code. This means you can reuse existing Java libraries or rewrite
computationally intensive code in Java.</p>
<p>This UDF uses the JSatTrak Java library to propagate out the TLE.
To use this UDF download
the <a href="http://www.gano.name/shawn/JSatTrak/bin_releases/JSatTrak_v4_1_bin.zip">JSatTrak binary distribution</a>.
Next copy the JARs from this distribution somewhere onto the Pig classpath.
The easiest way to do this is copying the JARs into the <code class="codehilite"><span class="err">$</span><span class="n">PIG_HOME</span><span class="o">/</span><span class="n">lib</span></code> directory.</p>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">jsattrak.objects</span> <span class="kn">import</span> <span class="n">SatelliteTleSGP4</span>

<span class="nd">@outputSchema</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    propagated:bag{</span>
<span class="s2">        positions:tuple(</span>
<span class="s2">            time:double, </span>
<span class="s2">            x:double, </span>
<span class="s2">            y:double, </span>
<span class="s2">            z:double</span>
<span class="s2">        )</span>
<span class="s2">    }</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">propagateTleECEF</span><span class="p">(</span>
    <span class="n">name</span><span class="p">,</span>
    <span class="n">line1</span><span class="p">,</span>
    <span class="n">line2</span><span class="p">,</span>
    <span class="n">start_time</span><span class="p">,</span>
    <span class="n">end_time</span><span class="p">,</span>
    <span class="n">number_of_points</span>
    <span class="p">):</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">satellite</span> <span class="o">=</span> <span class="n">SatelliteTleSGP4</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">line1</span><span class="p">,</span> <span class="n">line2</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>

    <span class="n">ecef_positions</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">end_time</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">end_time</span><span class="p">)</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">start_time</span><span class="p">)</span>
    <span class="n">number_of_points</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">number_of_points</span><span class="p">)</span>

    <span class="n">increment</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_time</span><span class="o">-</span><span class="n">start_time</span><span class="p">)</span><span class="o">/</span><span class="n">number_of_points</span>
    <span class="n">current_time</span> <span class="o">=</span> <span class="n">start_time</span>

    <span class="k">while</span> <span class="n">current_time</span> <span class="o">&lt;=</span> <span class="n">end_time</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">positions</span> <span class="o">=</span> <span class="p">[</span><span class="n">current_time</span><span class="p">]</span>
            <span class="n">current_positions</span> <span class="o">=</span> <span class="n">satellite</span><span class="o">.</span><span class="n">calculateJ2KPositionFromUT</span><span class="p">(</span><span class="n">current_time</span><span class="p">)</span>
            <span class="n">current_positions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">current_positions</span><span class="p">)</span>
            <span class="n">positions</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">current_positions</span><span class="p">)</span>
            <span class="n">ecef_positions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">positions</span><span class="p">))</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="n">current_time</span> <span class="o">+=</span> <span class="n">increment</span>

    <span class="k">return</span> <span class="n">ecef_positions</span>
</pre></div>

<p>This UDF takes a start time, end time and the number of desired points and outputs a bag of tuples.
A bag is similar to a Python list with the exception that bags in Pig are always unordered.
Tuples in Pig are like tuples in Python. They are immutable and ordered.</p>
<p>After adding the JARs to the classpath and adding the <code class="codehilite"><span class="n">propagateTleECEF</span></code>
function to <code class="codehilite"><span class="n">tleUDFs</span><span class="p">.</span><span class="n">py</span></code>, we are ready to propagate some orbits.</p>
<div class="codehilite"><pre><span></span><span class="nt">grunt</span> <span class="o">&gt;</span> <span class="nt">REGISTER</span> <span class="s1">&#39;tleUDFs.py&#39;</span> <span class="nt">USING</span> <span class="nt">jython</span> <span class="nt">AS</span> <span class="nt">myfuncs</span><span class="o">;</span>
<span class="nt">grunt</span><span class="o">&gt;</span> <span class="nt">gps</span> <span class="o">=</span> <span class="nt">LOAD</span> <span class="s1">&#39;gps-ops.tsv&#39;</span> <span class="nt">USING</span> <span class="nt">PigStorage</span><span class="o">()</span>
    <span class="nt">AS</span> <span class="o">(</span><span class="nt">name</span><span class="p">:</span><span class="nd">chararray</span><span class="o">,</span> <span class="nt">line1</span><span class="p">:</span><span class="nd">chararray</span><span class="o">,</span> <span class="nt">line2</span><span class="p">:</span><span class="nd">chararray</span><span class="o">);</span>
<span class="nt">grunt</span><span class="o">&gt;</span> <span class="nt">propagated</span> <span class="o">=</span> <span class="nt">FOREACH</span> <span class="nt">gps</span> <span class="nt">GENERATE</span> 
    <span class="nt">myfuncs</span><span class="p">.</span><span class="nc">parseTle</span><span class="o">(</span><span class="nt">name</span><span class="o">,</span> <span class="nt">line1</span><span class="o">,</span> <span class="nt">line2</span><span class="o">),</span>
    <span class="nt">myfuncs</span><span class="p">.</span><span class="nc">propagateTleECEF</span><span class="o">(</span>
        <span class="nt">name</span><span class="o">,</span> <span class="nt">line1</span><span class="o">,</span> <span class="nt">line2</span><span class="o">,</span> <span class="nt">2454992</span><span class="p">.</span><span class="nc">0</span><span class="o">,</span> <span class="nt">2454993</span><span class="p">.</span><span class="nc">0</span><span class="o">,</span> <span class="nt">100</span>
        <span class="o">);</span>
<span class="nt">grunt</span><span class="o">&gt;</span> <span class="nt">flattened</span> <span class="o">=</span> <span class="nt">FOREACH</span> <span class="nt">propagated</span> <span class="nt">GENERATE</span>
    <span class="nt">params</span><span class="err">#</span><span class="s1">&#39;satellite_number&#39;</span><span class="o">,</span> <span class="nt">FLATTEN</span><span class="o">(</span><span class="nt">propagated</span><span class="o">);</span>
</pre></div>

<p>The third command propagates out points for each satellite while the fourth command
flattens the results so that each position for each satellite is on its own line.
The <code class="codehilite"><span class="n">FLATTEN</span></code> operator will take a bag or tuple and flatten it. This operator works differently
based on whether it is flattening a bag or a tuple. Tuples are flattened in place in will not
generate additional relations. Bags are flattened into multiple additional relations.
The <code class="codehilite"><span class="k">DESCRIBE</span></code> command shows the new structure of each relation.</p>
<div class="codehilite"><pre><span></span><span class="n">grunt</span><span class="o">&gt;</span> <span class="k">DESCRIBE</span> <span class="n">propagated</span><span class="p">;</span>
<span class="n">propagated</span><span class="p">:</span> <span class="err">{</span><span class="n">params</span><span class="p">:</span> <span class="k">map</span><span class="p">[],</span><span class="n">propagated</span><span class="p">:</span>
    <span class="err">{</span><span class="n">positions</span><span class="p">:</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="n">double</span><span class="p">,</span><span class="n">x</span><span class="p">:</span> <span class="n">double</span><span class="p">,</span><span class="n">y</span><span class="p">:</span> <span class="n">double</span><span class="p">,</span><span class="n">z</span><span class="p">:</span> <span class="n">double</span><span class="p">)</span><span class="err">}}</span>
<span class="n">grunt</span><span class="o">&gt;</span> <span class="k">DESCRIBE</span> <span class="n">flattened</span><span class="p">;</span>
<span class="n">flattened</span><span class="p">:</span> <span class="err">{</span><span class="n">bytearray</span><span class="p">,</span>
    <span class="n">propagated</span><span class="p">::</span><span class="n">time</span><span class="p">:</span> <span class="n">double</span><span class="p">,</span><span class="n">propagated</span><span class="p">::</span><span class="n">x</span><span class="p">:</span>
    <span class="n">double</span><span class="p">,</span><span class="n">propagated</span><span class="p">::</span><span class="n">y</span><span class="p">:</span> <span class="n">double</span><span class="p">,</span><span class="n">propagated</span><span class="p">::</span><span class="n">z</span><span class="p">:</span> <span class="n">double</span><span class="err">}</span>
</pre></div>

<p>Notice that the flattened relation has an unnamed, untyped field for its first item.
This is the satellite number, but Pig does not know its type or name so it treats it as an
untyped byte array. We can fix this by using the AS operator to specify its name and type.
Looking at the data using the dump flattened command shows the positions.</p>
<div class="codehilite"><pre><span></span><span class="p">(</span><span class="mi">38833</span><span class="p">,</span><span class="mi">2454992</span><span class="p">.</span><span class="mi">9599999785</span><span class="p">,</span><span class="mi">2</span><span class="p">.</span><span class="mi">278136816721697</span><span class="n">E7</span><span class="p">,</span><span class="mi">7970303</span><span class="p">.</span><span class="mi">195970464</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">1066153998664627</span><span class="n">E7</span><span class="p">)</span>
<span class="p">(</span><span class="mi">38833</span><span class="p">,</span><span class="mi">2454992</span><span class="p">.</span><span class="mi">9699999783</span><span class="p">,</span><span class="mi">2</span><span class="p">.</span><span class="mi">2929498370345607</span><span class="n">E7</span><span class="p">,</span><span class="mi">1</span><span class="p">.</span><span class="mi">0245812732430315</span><span class="n">E7</span><span class="p">,</span><span class="o">-</span><span class="mi">8617450</span><span class="p">.</span><span class="mi">742994161</span><span class="p">)</span>
<span class="p">(</span><span class="mi">38833</span><span class="p">,</span><span class="mi">2454992</span><span class="p">.</span><span class="mi">979999978</span><span class="p">,</span><span class="mi">2</span><span class="p">.</span><span class="mi">2713614118860725</span><span class="n">E7</span><span class="p">,</span><span class="mi">1</span><span class="p">.</span><span class="mi">2358665040019082</span><span class="n">E7</span><span class="p">,</span><span class="o">-</span><span class="mi">6031915</span><span class="p">.</span><span class="mi">392826946</span><span class="p">)</span>
<span class="p">(</span><span class="mi">38833</span><span class="p">,</span><span class="mi">2454992</span><span class="p">.</span><span class="mi">989999978</span><span class="p">,</span><span class="mi">2</span><span class="p">.</span><span class="mi">213715624812226</span><span class="n">E7</span><span class="p">,</span><span class="mi">1</span><span class="p">.</span><span class="mi">4275325605036272</span><span class="n">E7</span><span class="p">,</span><span class="o">-</span><span class="mi">3350605</span><span class="p">.</span><span class="mi">7983842064</span><span class="p">)</span>
<span class="p">(</span><span class="mi">38833</span><span class="p">,</span><span class="mi">2454992</span><span class="p">.</span><span class="mi">9999999776</span><span class="p">,</span><span class="mi">2</span><span class="p">.</span><span class="mi">1209296863515433</span><span class="n">E7</span><span class="p">,</span><span class="mi">1</span><span class="p">.</span><span class="mi">5965381866069315</span><span class="n">E7</span><span class="p">,</span><span class="o">-</span><span class="mi">616098</span><span class="p">.</span><span class="mi">4598421039</span><span class="p">)</span>
</pre></div>

<p>At this point we can store off the propagated data so we can use it for future processing in Pig or in an
external program. Using <code class="codehilite"><span class="n">STORE</span></code> flattened into 'propagated' using <code class="codehilite"><span class="n">PigStorage</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span></code>
stores the data in the folder ‘propagated’ using comma-separated value files. Pig has other
storage options as well such as HBase or JSON. Pig also allows development of custom storage drivers.
We can load this data back into Pig using <code class="codehilite"><span class="k">LOAD</span></code>.</p>
<div class="codehilite"><pre><span></span><span class="nt">grunt</span><span class="o">&gt;</span> <span class="nt">propagated</span> <span class="o">=</span> <span class="nt">LOAD</span> <span class="s1">&#39;propagated&#39;</span>
    <span class="nt">using</span> <span class="nt">PigStorage</span><span class="o">(</span><span class="s1">&#39;,&#39;</span><span class="o">)</span> <span class="nt">AS</span> 
    <span class="o">(</span><span class="nt">satelliteNumber</span><span class="p">:</span><span class="nd">int</span><span class="o">,</span> <span class="nt">time</span><span class="p">:</span><span class="nd">double</span><span class="o">,</span> <span class="nt">x</span><span class="p">:</span><span class="nd">double</span><span class="o">,</span> <span class="nt">y</span><span class="p">:</span><span class="nd">double</span><span class="o">,</span> <span class="nt">z</span><span class="p">:</span><span class="nd">double</span><span class="o">);</span>
</pre></div>

<p>Using the ‘AS’ operator allows us to define the schema for the data.</p>
<div class="codehilite"><pre><span></span><span class="n">grunt</span><span class="o">&gt;</span> <span class="k">DESCRIBE</span> <span class="n">propagated</span><span class="p">;</span>
<span class="n">propagated</span><span class="p">:</span> <span class="err">{</span><span class="n">satelliteNumber</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span><span class="n">time</span><span class="p">:</span> <span class="n">double</span><span class="p">,</span><span class="n">x</span><span class="p">:</span> <span class="n">double</span><span class="p">,</span><span class="n">y</span><span class="p">:</span> <span class="n">double</span><span class="p">,</span><span class="n">z</span><span class="p">:</span> <span class="n">double</span><span class="err">}</span>
</pre></div>

<h2 id="conclusion">Conclusion<a class="headerlink" href="#conclusion" title="Permanent link">&para;</a></h2>
<p>Overall, Pig made it easy to process orbital data without needing to resort to cumbersome custom MapReduce code.
It handles all the boring details of creating and scheduling MapReduce jobs.
Pig is a valuable tool and will be a critical part of my data processing toolbox.</p>
<p>This post only scratches the surface of the true power of Pig. As an example,
I started down the path of developing a simple conjunction assessment algorithm
(conjunctions are when satellites in space get too close to one another and go boom)
using a Python UDF. It ran fine against small data sets, but ran out of heap memory on larger data sets.
I suspect I should be able to fine tune the processing to run efficiently against the whole data set.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2019 Shawn Hermans
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.245445c6.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
  </body>
</html>